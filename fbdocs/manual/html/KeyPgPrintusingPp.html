<html>
<head>
<title>Print # Using</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Print # Using</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Outputs formatted text to a file or device<br \>
<br \>
<div class="fb_sect_title">Syntax</div><div class="fb_sect_cont"><tt><br \>
<b>Print #</b> <i>filenum</i> <b>,</b> <b>Using</b> <i>formatstring</i> <b>;</b> [ <i>expressionlist</i> ]<br \>
</tt><br \>
</div><div class="fb_sect_title">Parameters</div><div class="fb_sect_cont"><br \>
<tt><i>filenum</i></tt><br \>
<div class="fb_indent">The file number of a file or device opened for <tt><a href="KeyPgOutput.html">Output</a></tt> or <tt><a href="KeyPgAppend.html">Append</a></tt>.<br \>
</div><tt><i>formatstring</i></tt><br \>
<div class="fb_indent">Format string to use.<br \>
</div><tt><i>expressionlist</i></tt><br \>
<div class="fb_indent">List of items to print, separated by semi-colons.<br \>
<br \>
</div></div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Output various expressions to a text file or device using a format determined by the <tt><i>formatstring</i></tt> parameter. Internally, <tt><b>Print Using</b></tt> uses a buffer size of 2048 bytes: while it is highly unlikely that this buffer would be filled, it should be noted that output would be truncated should this limit be reached.<br \>
<br \>
If no expression list is given, the format string will be printed up to the first special marker.  Note that the semi-colon after the format string is still necessary, even if no expression list is given.<br \>
<br \>
The format string dictates how the expressions are to be formatted when output to the screen, indicated by the use of special marker characters. There are markers for formatting both string and numeric output:<br \>
<br \>
</div><div class="fb_sect_title">String formatting</div><div class="fb_sect_cont"><br \>
<br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Marker</td><td>Formatting</td></tr><tr><td>!</td><td>prints the first character of a string</td></tr><tr><td>\   \</td><td>prints as many characters of a string as occuppied between the pair \ \</td></tr><tr><td>&amp;</td><td>prints the entire string</td></tr></table></div><br \>
<br \>
</div></div><div class="fb_sect_title">Numeric formatting</div><div class="fb_sect_cont"><br \>
<br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Marker</td><td>Formatting</td></tr><tr><td>#</td><td>placeholder for a digit</td></tr><tr><td>,</td><td> placed after integer digit indicates groups of 3 digits should be separated by commas</td></tr><tr><td>.</td><td> placed near # indicates place for the decimal point</td></tr><tr><td>+</td><td>prints the sign of the number when placed to the left of numeric formatting</td></tr><tr><td>^^^^</td><td>prints exponential notation when placed to the right of numeric formatting</td></tr><tr><td>&amp;</td><td>prints a number intelligently, using the exact number of digits required (new to version 0.21.0b)</td></tr></table></div><br \>
<br \>
</div>All of the special marker characters can be escaped, or preceded, with the underscore character <tt>"_"</tt>, allowing them to be printed directly.  For example, <tt>"_!"</tt> is printed as <tt>"!"</tt>.<br \>
<br \>
If a numerical value doesn't fit in the form indicated by the format string, the formatting is ignored and the number is printed preceded by the percent <tt>"%"</tt> character. E.g., the number <tt>1234</tt> with a <tt><i>formatstring</i></tt> of <tt>"##.##"</tt> would be printed as <tt>"%1234.00"</tt>.<br \>
<br \>
All other characters within the format string are printed as they appear.<br \>
<br \>
</div><div class="fb_sect_title">Example</div><div class="fb_sect_cont"><br \>
<br \>
<tt><div class="freebasic">
<span class="key">Const</span>&nbsp;<span class="wrd">filename</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"file.txt"</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">filenum</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">FreeFile</span><span class="oth">()</span><br />
<span class="key">If</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="key">Open</span><span class="oth">(</span><span class="wrd">filename</span><span class="oth">,</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Output</span><span class="oth">,</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">filenum</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"error&nbsp;opening&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">filename</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">"&nbsp;for&nbsp;output."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="oth">-</span><span class="num">1</span><br />
<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="oth">#</span><span class="wrd">filenum</span><span class="oth">,</span>&nbsp;<span class="key">Using</span>&nbsp;<span class="quo">"This&nbsp;file&nbsp;is&nbsp;called&nbsp;'&amp;'"</span><span class="oth">;</span>&nbsp;<span class="wrd">filename</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="oth">#</span><span class="wrd">filenum</span><span class="oth">,</span>&nbsp;<span class="quo">"Some&nbsp;numerical&nbsp;values&nbsp;are:"</span><br />
<span class="key">Print</span>&nbsp;<span class="oth">#</span><span class="wrd">filenum</span><span class="oth">,</span>&nbsp;<span class="key">Using</span>&nbsp;<span class="quo">"'###',&nbsp;'+###.###'"</span><span class="oth">;</span>&nbsp;<span class="num">123.456</span><span class="oth">,</span>&nbsp;<span class="oth">-</span><span class="num">123.456</span><br />
<br />
<span class="key">Close</span><span class="oth">(</span><span class="wrd">filenum</span><span class="oth">)</span><br />
</div></tt><br />
will produce the file:<br \>
<pre class="fb_pre">
This file is called 'file.txt'
Some numerical values are:
'123', '-123.456'
</pre><br \>
</div><div class="fb_sect_title">Differences from QB</div><div class="fb_sect_cont"><br \>
<ul><li> QB didn't allow <tt>"&"</tt> to be used for printing numbers.<br \>
<br \>
</ul></div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgPrintPp.html">Print #</a></tt><br \>
<li> <tt><a href="KeyPgPrintusing.html">Print Using</a></tt><br \>
<li> <tt><a href="KeyPgFormat.html">Format</a></tt><br \>
<li> <tt><a href="KeyPgOpen.html">Open</a></tt><br \>
<li> <tt><a href="KeyPgUsing.html">Using</a></tt><br \>
<li> <tt><a href="KeyPgPalette.html">Palette Using</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
