<html>
<head>
<title>Destructor (Module)</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Destructor (Module)</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Specifies execution of a procedure at program termination<br \>
<br \>
<div class="fb_sect_title">Syntax</div><div class="fb_sect_cont"><tt><br \>
[<a href="KeyPgPublic.html">Public</a> | <a href="KeyPgPrivate.html">Private</a>] <a href="KeyPgSub.html">Sub</a> <i>identifier</i> [<a href="KeyPgAlias.html">Alias</a> "<i>external_identifier</i>"] [()] <b>Destructor</b> [<i>priority</i>] [<a href="KeyPgStatic.html">Static</a>]<br \>
<div class="fb_indent">{ <i>procedure body</i> }<br \>
</div><a href="KeyPgEnd.html">End</a> <a href="KeyPgSub.html">Sub</a><br \>
</tt><br \>
</div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Defines a procedure to be automatically called from a compiled program's end-code.  End-code is generated by the compiler and is executed when the program terminates normally.  Procedures defined as destructors may be used the same way as ordinary procedures, that is, they may be called from within module-level code, as well as other procedures.  <br \>
<br \>
The procedure must have an empty parameter list.  A compile-time error will be generated if the <tt><b>Destructor</b></tt> keyword is used in a Sub definition having one or more parameters. In a set of overloaded procedures, only one (1) destructor may be defined because of the ambiguity of having multiple Subs which take no arguments.<br \>
<br \>
In a single module, destructors normally execute in the order in which they are defined.<br \>
<br \>
The <tt><i>priority</i></tt> attribute, an integer between 101 and 65535, can be used to force destructors to be executed in a certain order.  The value of <tt><i>priority</i></tt> has no specific meaning, only the relationship of the number with other destructor priorities. 101 is the lowest priority and is executed last.  All destructors having a <tt><i>priority</i></tt> attribute are executed after destructors with no attribute.  The priority value of 65535 is the same as not assigning a priority value.<br \>
<br \>
A module may define multiple destructor procedures.  Destructor procedures may also appear in more than one module. All procedures defined with the syntax shown above will be added to the list of procedures to be called during the program's termination.<br \>
<br \>
The order in which destructors defined in multiple modules are executed is known only at link time.  Therefore, special care should be taken when using destructors that may call on a secondary module also defining a destructors.  In such a case it is advisable to use a single destructor that explicit calls termination procedures in multiple modules to ensure a graceful termination of the application.<br \>
<br \>
Destructors will be called if the program terminates normally or if error-checking is enabled and the program terminates abnormally.<br \>
<br \>
</div><div class="fb_sect_title">Example</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">pauseonexit</span>&nbsp;<span class="key">Destructor</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;If&nbsp;the&nbsp;program&nbsp;reaches&nbsp;the&nbsp;end,&nbsp;or&nbsp;aborts&nbsp;with&nbsp;an&nbsp;error,&nbsp;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;it&nbsp;will&nbsp;run&nbsp;this&nbsp;destructor&nbsp;before&nbsp;closing</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"Press&nbsp;any&nbsp;key&nbsp;to&nbsp;end&nbsp;the&nbsp;program..."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Sleep</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">array</span><span class="oth">(</span><span class="num">0</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">10</span><span class="oth">,</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">10</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="wrd">j</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">11</span><br />
<br />
<span class="com">''&nbsp;this&nbsp;next&nbsp;line&nbsp;will&nbsp;cause&nbsp;the&nbsp;program&nbsp;to&nbsp;abort&nbsp;with&nbsp;an&nbsp;</span><br />
<span class="com">''&nbsp;error&nbsp;if&nbsp;you&nbsp;compile&nbsp;with&nbsp;array&nbsp;bounds&nbsp;checking&nbsp;enabled&nbsp;(fbc&nbsp;-exx&nbsp;...)</span><br />
<span class="key">Print</span>&nbsp;<span class="wrd">array</span><span class="oth">(</span><span class="wrd">i</span><span class="oth">,</span>&nbsp;<span class="wrd">j</span><span class="oth">)</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Differences from QB</div><div class="fb_sect_cont"><br \>
<ul><li> New to FreeBASIC<br \>
<br \>
</ul></div><div class="fb_sect_title">See also</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgDestructor.html">Destructor (Class)</a></tt><br \>
<li> <tt><a href="KeyPgModuleConstructor.html">Constructor (Module)</a></tt><br \>
<li> <tt><a href="KeyPgSub.html">Sub</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
